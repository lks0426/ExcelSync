# ExcelSync 端口清理工具

快速关闭 ExcelSync 应用相关端口（3000, 3001, 8000, 8001）的脚本工具。

## 文件说明

### Linux/macOS 版本
- **文件名**: `kill-ports.sh`
- **使用方法**: `./kill-ports.sh`

### Windows 版本
- **文件名**: `kill-ports.bat`
- **使用方法**: 双击运行或在命令行执行 `kill-ports.bat`

## 功能特性

✅ **智能检测**: 自动检测端口占用情况  
✅ **安全关闭**: 优雅地关闭占用端口的进程  
✅ **状态反馈**: 显示每个端口的清理状态  
✅ **友好界面**: 中文界面，清晰的状态提示  
✅ **启动提示**: 提供应用重启命令提示  

## 清理的端口

| 端口 | 用途 | 应用 |
|------|------|------|
| 3000 | 前端开发服务器 | Next.js (npm run dev) |
| 3001 | 前端备用端口 | Next.js 备用 |
| 8000 | 后端API服务器 | Flask (python app.py) |
| 8001 | 后端备用端口 | Flask 备用 |

## 使用场景

🔧 **开发环境重启**: 当需要重新启动开发环境时  
🚫 **端口冲突解决**: 当端口被其他进程占用时  
🧹 **环境清理**: 开发结束后清理端口资源  
⚡ **快速重置**: 一键重置所有相关端口  

## 使用步骤

### Linux/macOS
```bash
# 进入项目目录
cd /home/ubuntu/ExcelSync

# 执行清理脚本
./kill-ports.sh

# 重启应用（可选）
cd frontend && npm run dev &
cd ../backend && python app.py &
```

### Windows
```batch
REM 双击运行 kill-ports.bat 或在命令行执行
kill-ports.bat

REM 重启应用（可选）
cd frontend && npm run dev
cd backend && python app.py
```

## 输出示例

```
🔄 开始清理 ExcelSync 相关端口...
========================================
🔍 检查端口 3000...
❌ 端口 3000 正在被使用，正在关闭...
✅ 端口 3000 已成功关闭
🔍 检查端口 3001...
✅ 端口 3001 已经可用
🔍 检查端口 8000...
✅ 端口 8000 已经可用
🔍 检查端口 8001...
✅ 端口 8001 已经可用
========================================
🎉 端口清理完成！

端口状态：
  端口 3000: ✅ 可用
  端口 3001: ✅ 可用
  端口 8000: ✅ 可用
  端口 8001: ✅ 可用

💡 提示：
  - 前端启动: cd frontend && npm run dev
  - 后端启动: cd backend && python app.py
```

## 注意事项

⚠️ **权限要求**: Linux/macOS版本需要sudo权限来关闭进程  
⚠️ **数据保存**: 运行前请确保已保存所有工作，强制关闭可能导致未保存数据丢失  
⚠️ **其他应用**: 脚本会关闭占用这些端口的所有进程，包括非ExcelSync应用  

## 故障排除

**端口仍在使用？**
- 等待几秒后重新运行脚本
- 检查是否有其他应用占用了这些端口
- Windows用户可以尝试以管理员身份运行

**权限不足？**
- Linux/macOS: 确保具有sudo权限
- Windows: 以管理员身份运行命令提示符或PowerShell

**脚本无法执行？**
- Linux/macOS: 运行 `chmod +x kill-ports.sh` 添加执行权限
- Windows: 检查是否启用了脚本执行策略