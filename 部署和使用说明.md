# MarkdownSync - 部署和使用说明

## 系统概述

MarkdownSync 是一个现代化的 Markdown 表格解析系统，能够将 Markdown 文件中的表格数据转换为结构化的 JSON 格式，并提供美观的数据预览界面。

## 功能特点

- 🎨 **现代化UI设计** - 玻璃拟态风格，支持深色/浅色主题
- 📝 **Markdown表格解析** - 智能解析MD文件中的表格数据
- 🚀 **实时处理** - 拖拽上传，实时解析进度显示
- 📱 **响应式设计** - 完美适配桌面和移动设备
- 🔄 **多文件支持** - 支持批量上传和解析
- 💾 **数据导出** - 支持CSV格式导出

## 技术架构

### 前端
- **框架**: Next.js 14 + TypeScript
- **样式**: Tailwind CSS + 自定义玻璃拟态设计
- **动画**: Framer Motion
- **组件**: React + 自定义Hook

### 后端
- **框架**: Flask + Python
- **解析器**: 自定义Markdown表格解析器
- **API**: RESTful API设计
- **跨域**: Flask-CORS支持

## 安装部署

### 环境要求

- **Node.js**: 18.0 或更高版本
- **Python**: 3.8 或更高版本
- **包管理器**: npm 或 yarn

### 1. 克隆项目

```bash
git clone <repository-url>
cd ExcelSync
```

### 2. 后端部署

```bash
# 进入后端目录
cd backend

# 安装Python依赖
pip install -r requirements.txt

# 启动后端服务器
python run.py
```

后端服务器将在 `http://localhost:8001` 启动。

### 3. 前端部署

```bash
# 进入前端目录
cd frontend

# 安装依赖
npm install

# 创建环境配置文件
cp .env.local.example .env.local

# 启动开发服务器
npm run dev
```

前端应用将在 `http://localhost:3000` 启动。

### 4. 生产环境部署

#### 后端生产部署

```bash
# 使用Gunicorn (推荐)
pip install gunicorn
gunicorn -w 4 -b 0.0.0.0:8001 app:app

# 或使用uWSGI
pip install uwsgi
uwsgi --http 0.0.0.0:8001 --wsgi-file app.py --callable app
```

#### 前端生产部署

```bash
# 构建生产版本
npm run build

# 启动生产服务器
npm start

# 或使用PM2
npm install -g pm2
pm2 start npm --name "markdownsync-frontend" -- start
```

## API接口文档

### 基础信息

- **Base URL**: `http://localhost:8001`
- **Content-Type**: `application/json` 或 `multipart/form-data`
- **支持格式**: `.md`, `.markdown`, `.txt`
- **最大文件大小**: 16MB

### 核心接口

#### 1. 健康检查
```
GET /api/health
```

#### 2. 解析单个MD文件
```
POST /api/parse-md
Content-Type: multipart/form-data

参数:
- file: Markdown文件
```

#### 3. 批量解析MD文件
```
POST /api/parse-multiple-md
Content-Type: multipart/form-data

参数:
- files: 多个Markdown文件
```

#### 4. 解析MD文本内容
```
POST /api/parse-md-text
Content-Type: application/json

Body:
{
  "content": "Markdown内容",
  "filename": "文件名"
}
```

#### 5. 获取示例内容
```
GET /api/sample-md
```

### 响应格式

成功响应示例：
```json
{
  "success": true,
  "data": {
    "headers": ["列1", "列2", "列3"],
    "data": [
      {"列1": "值1", "列2": "值2", "列3": "值3"}
    ],
    "summary": {
      "totalRows": 1,
      "totalColumns": 3,
      "fileName": "test.md",
      "fileSize": 1024,
      "parsedAt": "2024-01-15T10:30:00.000Z"
    },
    "metadata": {
      "type": "markdown_table",
      "encoding": "utf-8",
      "hasHeaders": true
    }
  }
}
```

## 使用说明

### 1. 基本使用流程

1. **启动服务**: 确保后端和前端服务都已启动
2. **上传文件**: 将MD文件拖拽到上传区域或点击选择文件
3. **解析数据**: 点击"Parse Markdown"按钮开始解析
4. **查看结果**: 在数据预览区域查看解析后的表格数据
5. **导出数据**: 点击下载按钮导出CSV格式数据

### 2. 支持的Markdown表格格式

基本表格语法：
```markdown
| 列1 | 列2 | 列3 |
|-----|-----|-----|
| 值1 | 值2 | 值3 |
| 值4 | 值5 | 值6 |
```

带对齐的表格：
```markdown
| 左对齐 | 居中对齐 | 右对齐 |
|:-------|:-------:|-------:|
| 内容1  |  内容2  |  内容3 |
```

### 3. 数据类型识别

解析器会自动识别以下数据类型：
- **数字**: 123, 45.67, 1,234
- **布尔值**: true, false, 是, 否
- **字符串**: 任何文本内容
- **空值**: 空单元格将显示为 null

### 4. 文件要求

- **格式**: .md, .markdown, .txt
- **大小**: 最大 16MB
- **编码**: UTF-8 编码
- **表格**: 至少包含一个有效的Markdown表格

## 故障排除

### 常见问题

#### 1. 后端启动失败
**问题**: `ModuleNotFoundError` 或依赖缺失
**解决**:
```bash
pip install -r requirements.txt
python -c "from md_parser import MDParser; print('导入成功')"
```

#### 2. 端口被占用
**问题**: `Address already in use`
**解决**:
```bash
# 查看端口占用
lsof -i :8001

# 修改端口或停止占用进程
kill -9 <PID>
```

#### 3. 前后端连接失败
**问题**: API调用失败或CORS错误
**解决**:
- 确认后端服务器正在运行
- 检查 `.env.local` 中的API地址配置
- 验证防火墙设置

#### 4. 解析结果为空
**问题**: 上传文件后解析无结果
**解决**:
- 检查文件格式是否为标准Markdown表格
- 确认文件编码为UTF-8
- 验证表格语法是否正确

### 调试工具

#### 1. 后端调试
```bash
# 测试MD解析器
python md_parser.py

# 测试API接口
python test_api.py
```

#### 2. 前端调试
```bash
# 开发模式启动
npm run dev

# 类型检查
npm run type-check

# 语法检查
npm run lint
```

## 开发说明

### 项目结构
```
ExcelSync/
├── backend/                 # 后端Python服务
│   ├── app.py              # Flask应用主文件
│   ├── md_parser.py        # Markdown解析器
│   ├── requirements.txt    # Python依赖
│   ├── run.py             # 启动脚本
│   └── test_api.py        # API测试脚本
├── frontend/               # 前端Next.js应用
│   ├── src/               # 源代码
│   │   ├── app/           # Next.js应用页面
│   │   ├── components/    # React组件
│   │   ├── lib/          # 工具函数和API
│   │   └── types/        # TypeScript类型定义
│   ├── package.json      # Node.js依赖
│   └── tailwind.config.ts # 样式配置
└── docs/                  # 文档目录
```

### 扩展开发

#### 添加新的解析功能
1. 在 `md_parser.py` 中扩展 `MDParser` 类
2. 更新API接口以支持新功能
3. 在前端添加相应的UI组件

#### 自定义主题
1. 修改 `tailwind.config.ts` 中的颜色定义
2. 更新 `globals.css` 中的CSS变量
3. 调整组件中的样式类名

#### 添加新的文件格式支持
1. 在后端创建新的解析器模块
2. 更新文件验证逻辑
3. 修改前端的文件类型限制

## 许可证

本项目采用 MIT 许可证。详细信息请查看 LICENSE 文件。

## 支持与联系

如有问题或建议，请通过以下方式联系：

- 📧 Email: [your-email@example.com]
- 💬 Issues: [GitHub Issues页面]
- 📚 文档: [项目文档地址]

---

**MarkdownSync** - 让Markdown表格数据处理变得简单高效！ 🚀